<%- include("./partials/header.ejs") %>

<body>
    <%- include("partials/navbar.ejs") %>
    <div class="wrapper">
        <div class="table-header" style="padding-left: 15px;">
            <div id="filtering">
                <div style="margin-right: 10px;">
                    <img width="50px" src="/img/icons/<%= community.id %>.jpg" style="margin-right: 2px;">
                    <span><%= community.name %></span>
                </div>
                <div>
                    Showing <select oninput="show_entries(this.value)">
                        <option value="15">15</option>
                        <option value="30">30</option>
                        <option value="60">60</option>
                        <option value="80">80</option>
                        <option value="<%= posts.length %>">All (<%= posts.length %>)</option>
                    </select>Posts
                </div>
            </div>  
        </div>
        <table id="admin_table" class="table table-striped table-bordered" style="padding: 20px;">
            <thead class="thead-dark">
                <tr>
                    <th>Time Created</th>
                    <th>Mii</th>
                    <th>ID</th>
                    <th>Community ID</th>
                    <th>Content</th>
                    <th>Screenshot</th>
                    <th>Title ID</th>
                    <th>Posted From</th>
                    <th>TItle Owned</th>
                    <th>PID</th>
                    <th>Topic Tag</th>
                    <th>Spoiler</th>
                    <th>Options</th>
                </tr>
            </thead>
            <tbody>
                <% for (let i=0; i < posts.length; i++) { const post=posts[i];%>
                    <tr <%= (i >= 15) ? 'style=display:none' : "" %>>
                        <td><%= moment(post.create_time).format("MM/DD/YYYY h:mm A") %></td>
                        <td><img width="50px" src="http://mii-images.account.nintendo.net/<%= post.mii_hash %>_normal_face.png"></td>
                        <td><%= post.id %></td>
                        <td><%= post.community_id %></td>
                        <td><% if (post.body) {%> <%= post.body %> <%} else {%> <img src="/img/paintings/<%= post.id %>.png" width="200px"> <%} %></td>
                        <td><% if (post.screenshot) {%> <img width="100px" src="/img/screenshots/<%= post.id %>.jpg"> <%}%> </td>
                        <td><%= post.title_id %></td>
                        <td><%= post.posted_from %></td>
                        <td><%= post.title_owned %></td>
                        <td><%= post.pid %></td>
                        <td><%= post.topic_tag %></td>
                        <td><%= post.spoiler %></td>
                        <td>
                            <div>
                                <label>Moderated</label>
                                <input postid="<%= post.id %>" type="checkbox" autocomplete="off" onchange="moderatePost(this.attributes[0].value)" <%= (post.moderated == 1) ? "checked" : "" %>>
                            </div>
                        </td>
                    </tr>
                <%} %>
            </tbody>
        </table>
    </div>
</body>

<script>
    loadPostTimes();
</script>

</html>